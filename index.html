<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Diamond - Better Gaming</title>
  <link rel="icon" href="favicon.png" type="image/png">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: #030308;
      --panel: rgba(255,255,255,0.03);
      --glass-soft: rgba(255,255,255,0.05);
      --accent1: 220 85% 62%;
      --accent2: 280 85% 62%;
      --text: #e7eef6;
      --text-soft: rgba(231,238,246,0.75);
      --radius: 14px;
    }

    * { margin:0; padding:0; box-sizing:border-box; }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: Inter, system-ui, sans-serif;
      -webkit-font-smoothing: antialiased;
      overflow-x: hidden;
    }

    /* HUD */
    .hud {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 92%;
      max-width: 1250px;
      padding: 14px 22px;
      display:flex;
      align-items:center;
      gap:16px;
      border-radius: var(--radius);
      background: rgba(255,255,255,0.08);
      backdrop-filter: blur(10px) saturate(70%);
      border:1px solid rgba(255,255,255,0.05);
      box-shadow: 0 4px 16px rgba(0,0,0,0.35);
      z-index: 49 !important;
    }

    .logo { display:flex; align-items:center; gap:12px; }
    .logo img {
      width:42px;
      height:42px;
      border-radius:10px;
      box-shadow:0 4px 18px rgba(147,51,234,0.4);
    }
    .logo h1 { font-size:20px; font-weight:700; margin-bottom:-4px; }
    .logo small { font-size:12px; color:var(--text-soft); }

    .right { margin-left:auto; display:flex; gap:10px; }

    .hud button {
      padding:10px 18px;
      border:none;
      border-radius:10px;
      background:rgba(255,255,255,0.05);
      color:white;
      font-weight:600;
      cursor:pointer;
      transition:150ms;
    }
    .hud button:hover { background:rgba(255,255,255,0.10); transform:translateY(-1px); }
    .hud button.active {
      background:linear-gradient(135deg, hsl(var(--accent1)), hsl(var(--accent2)));
      box-shadow:0 6px 20px rgba(0,0,0,0.35);
    }

    .pill {
      padding:6px 12px;
      background:rgba(255,255,255,0.06);
      border-radius:999px;
      font-size:13px;
    }

    /* HOMEPAGE */
    .home-wrap {
      padding-top: 130px;
      width: 100%;
      max-width: 1400px;
      margin: auto;
    }

    .featured-strip {
      width: 100%;
      padding: 10px 0;
      display: flex;
      justify-content: center;
    }

    .featured-scroll {
      display: flex;
      gap: 12px;
      padding: 12px;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 14px;
      box-shadow: 0 0 12px rgba(0,0,0,0.3);
      overflow-x: auto;
      white-space: nowrap;
    }

    .featured-scroll img {
      height: 65px;
      width: 120px;
      object-fit: cover;
      border-radius: 10px;
    }

    .home-content {
      margin-top: 60px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 40px;
      padding: 0 20px;
    }

    .welcome h1 {
      font-size: 48px;
      font-weight: 800;
      line-height: 1.1;
    }

    .highlight {
      background: linear-gradient(90deg, hsl(var(--accent1)), hsl(var(--accent2)));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .sub {
      margin-top: 10px;
      font-size: 18px;
      color: var(--text-soft);
    }

    .start-btn {
      margin-top: 20px;
      padding: 12px 22px;
      background: linear-gradient(90deg, hsl(var(--accent1)), hsl(var(--accent2)));
      border-radius: 12px;
      border: none;
      color: white;
      font-weight: 700;
      cursor: pointer;
      font-size: 16px;
      transition:150ms;
    }
    .start-btn:hover { transform: translateY(-2px); }

    .big-feature-card {
      width: 310px;
      padding: 18px;
      background: rgba(255,255,255,0.05);
      border-radius: 20px;
      box-shadow: 0 0 20px rgba(0,0,0,0.35);
      border: 1px solid rgba(255,255,255,0.06);
      text-align: center;
    }

    .big-feature-card img {
      width: 100%;
      border-radius: 14px;
    }

    .big-feature-card h3 {
      margin-top: 15px;
      font-size: 20px;
    }

    .big-feature-card button {
      margin-top: 12px;
      width: 100%;
      padding: 10px;
      border: none;
      background: rgba(255,255,255,0.08);
      color: white;
      border-radius: 10px;
      cursor: pointer;
    }
    .big-feature-card button:hover {
      background: rgba(255,255,255,0.12);
    }

    /* Original hero section (for Games/Apps) */
    .hero {
      padding-top:130px;
      text-align:center;
    }
    .hero h2 {
      font-size:42px;
      font-weight:800;
      background:linear-gradient(90deg, hsl(var(--accent1)), hsl(var(--accent2)));
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      margin-bottom:6px;
    }
    .hero p { color:var(--text-soft); }

    .search-wrap { margin-top:22px; display:flex; justify-content:center; }
    .search {
      width:680px; max-width:92%; padding:14px 20px;
      border-radius:999px; display:flex;
      background:rgba(255,255,255,0.05);
      border:1px solid rgba(255,255,255,0.05);
      box-shadow:0 0 8px rgba(99,102,241,0.18);
      transition:150ms;
    }
    .search input {
      flex:1; background:transparent; border:none; outline:none;
      font-size:16px; color:var(--text);
    }

    .grid {
      display:grid;
      grid-template-columns:repeat(auto-fill, minmax(240px, 1fr));
      gap:26px; padding:40px 22px;
      max-width:1250px; margin:auto;
    }

    .card {
      background:rgba(255,255,255,0.03);
      border:1px solid rgba(255,255,255,0.05);
      border-radius:var(--radius);
      height:300px;
      padding:12px;
      transition:150ms;
      box-shadow:0 2px 6px rgba(0,0,0,0.25);
    }
    .card:hover { transform:translateY(-3px); }

    .thumb {
      width:100%; height:155px; object-fit:cover;
      border-radius:10px;
    }

    .meta { text-align:center; padding-top:14px; }
    .meta h3 { font-size:18px; margin-bottom:10px; }

    .play {
      padding:10px 16px;
      border:none;
      border-radius:10px;
      background:linear-gradient(90deg, hsl(var(--accent1)), hsl(var(--accent2)));
      color:white; cursor:pointer;
    }
  </style>
</head>
<body>

  <!-- TOP BAR -->
  <div class="hud">
    <div class="logo">
      <img src="favicon.png" alt="Logo">
      <div>
        <h1>Diamond</h1>
        <small>Upgraded Gaming</small>
      </div>
    </div>

    <div class="right">
      <button id="homeTab" class="active">Home</button>
      <button id="gamesTab">Games</button>
      <button id="appsTab">Apps</button>
      <button id="unlockerTab">Unlocker</button>
      <span id="gamesCount" class="pill" style="display:none;">Count: 0</span>
      <button id="settingsButton">Settings</button>
    </div>
  </div>

  <main>

    <!-- HOME SECTION -->
    <section id="homeSection" class="home-wrap">
      <!-- TOP FEATURED STRIP -->
      <div class="featured-strip">
        <div class="featured-scroll" id="featuredScroll"></div>
      </div>

      <div class="home-content">
        <!-- LEFT: WELCOME -->
        <div class="welcome">
          <h1>
            Welcome to <br>
            <span class="highlight">Diamond.</span>
          </h1>

          <p class="sub">Game on!</p>

          <button class="start-btn" id="startGamingBtn">Start Gaming</button>
        </div>

        <!-- RIGHT: BIG FEATURE -->
        <div class="big-feature-card" id="bigFeaturedCard">
          <!-- populated by JS -->
        </div>
      </div>
    </section>

    <!-- ORIGINAL HERO (HIDDEN UNTIL GAMES/APPS TAB) -->
    <section class="hero" id="gameHero" style="display:none;">
      <h2>Diamond â€” Upgraded Gaming</h2>
      <p>Jump into any game, instantly.</p>

      <div class="search-wrap">
        <div class="search">
          <input id="q" placeholder="Search..." />
        </div>
      </div>
    </section>

    <!-- ORIGINAL GRID (HIDDEN UNTIL GAMES/APPS TAB) -->
    <section class="grid" id="grid" style="display:none;"></section>

  </main>
  <!-- MODAL -->
  <div id="modal">
    <div>
      <button id="closeModal">Close</button>
      <button id="fullscreenBtn">Fullscreen</button>

      <iframe id="gameFrame"
        style="width:100%;height:100%;border:none"
        sandbox="allow-scripts allow-same-origin allow-pointer-lock"></iframe>
    </div>
  </div>

  <!-- SETTINGS MODAL -->
  <div id="settingsModal">
    <div>
      <h2 style="margin-bottom:10px;">Settings</h2>
      <div id="themeOptions"></div>

      <button id="closeSettings"
        style="
          margin-top:20px;
          padding:10px 16px;
          border:none;
          border-radius:10px;
          background:rgba(255,255,255,0.08);
          color:white;
          cursor:pointer;
        ">
        Close
      </button>
    </div>
  </div>

  <script>
    /* ELEMENTS */
    const homeTab = document.getElementById('homeTab');
    const gamesTab = document.getElementById('gamesTab');
    const appsTab = document.getElementById('appsTab');
    const unlockerTab = document.getElementById('unlockerTab');
    const settingsButton = document.getElementById('settingsButton');

    const homeSection = document.getElementById('homeSection');
    const gameHero = document.getElementById('gameHero');
    const grid = document.getElementById('grid');
    const featuredScroll = document.getElementById('featuredScroll');
    const bigFeaturedCard = document.getElementById('bigFeaturedCard');

    const modal = document.getElementById('modal');
    const gameFrame = document.getElementById('gameFrame');
    const closeModal = document.getElementById('closeModal');
    const fullscreenBtn = document.getElementById('fullscreenBtn');

    const searchInput = document.getElementById('q');

    const settingsModal = document.getElementById('settingsModal');
    const closeSettings = document.getElementById('closeSettings');

    const gamesCountElement = document.getElementById('gamesCount');

    let lastActiveTab = "home";
    let GAMES = [];
    let APPS = [];

    /* HOME / FEATURED DATA (edit thumbs/src to match your files) */
    const HOME_FEATURED = [
      { title: "Highway Racer", thumb: "highway.jpg", src: "highway.html" },
      { title: "Gun Mayhem", thumb: "gun.jpg", src: "gun.html" },
      { title: "Neon Tunnel", thumb: "tunnel.jpg", src: "tunnel.html" },
      { title: "Kart Battle", thumb: "kart.jpg", src: "kart.html" },
      { title: "F1 Racing", thumb: "f1.jpg", src: "f1.html" },
      { title: "PolyTrack", thumb: "polytrack.jpg", src: "polytrack.html" }
    ];

    /* Utility: create card for grid (games/apps) */
    function createCard(item) {
      const el = document.createElement('article');
      el.className = 'card';

      const img = document.createElement('img');
      img.className = 'thumb';
      img.src = item.thumb || item.image || "";
      img.loading = "lazy";
      img.alt = item.title || "Game";

      const meta = document.createElement('div');
      meta.className = 'meta';

      const h3 = document.createElement('h3');
      h3.textContent = item.title || "Untitled";

      const btn = document.createElement('button');
      btn.className = 'play';
      btn.textContent = 'Play';
      btn.addEventListener('click', (e) => {
        e.stopPropagation();
        openItem(item);
      });

      meta.appendChild(h3);
      meta.appendChild(btn);
      el.appendChild(img);
      el.appendChild(meta);

      return el;
    }

    /* Render home top strip */
    function renderHomeStrip() {
      featuredScroll.innerHTML = "";
      HOME_FEATURED.forEach(g => {
        const img = document.createElement('img');
        img.src = g.thumb;
        img.alt = g.title;
        img.title = g.title;
        img.style.cursor = "pointer";
        img.addEventListener('click', () => {
          // when clicking a small thumb, make it the big card
          renderBigCard(g);
        });
        featuredScroll.appendChild(img);
      });
    }

    /* Render big featured card (defaults to index 3) */
    function renderBigCard(forcedGame) {
      const game = forcedGame || HOME_FEATURED[3] || HOME_FEATURED[0];
      bigFeaturedCard.innerHTML = "";

      const img = document.createElement('img');
      img.src = game.thumb;
      img.alt = game.title;

      const h3 = document.createElement('h3');
      h3.textContent = game.title;

      const btn = document.createElement('button');
      btn.textContent = "Play";
      btn.addEventListener('click', () => openItem(game));

      bigFeaturedCard.appendChild(img);
      bigFeaturedCard.appendChild(h3);
      bigFeaturedCard.appendChild(btn);
    }

    /* Load Games JSON */
    function loadGames() {
      fetch('arcade_data.json')
        .then(r => r.json())
        .then(data => {
          GAMES = data.games || [];
          render(GAMES);
          updateCount();
        })
        .catch(() => {
          GAMES = [];
          render(GAMES);
          updateCount();
        });
    }

    /* Load Apps JSON */
    function loadApps() {
      fetch('apps_data.json')
        .then(r => r.json())
        .then(data => {
          APPS = data.apps || [];
          render(APPS);
          updateCount();
        })
        .catch(() => {
          APPS = [];
          render(APPS);
          updateCount();
        });
    }

    /* Render grid for games/apps */
    function render(items) {
      const q = (searchInput?.value || "").toLowerCase();
      grid.innerHTML = "";

      items
        .filter(item => (item.title || "").toLowerCase().includes(q))
        .forEach(item => grid.appendChild(createCard(item)));
    }

    /* Open item in modal (attempt to fetch HTML or load src in iframe) */
    function openItem(item) {
      modal.style.display = 'flex';

      // If the item has HTML file path, fetch and write into iframe document.
      if (item.src && item.src.endsWith('.html')) {
        fetch(item.src)
          .then(r => r.text())
          .then(html => {
            const doc = gameFrame.contentDocument || gameFrame.contentWindow.document;
            doc.open();
            doc.write(html);
            doc.close();
          })
          .catch(() => {
            const doc = gameFrame.contentDocument || gameFrame.contentWindow.document;
            doc.open();
            doc.write('<div style="color:white;padding:20px;">Failed to load game.</div>');
            doc.close();
          });
        return;
      }

      // Otherwise attempt to set iframe.src
      if (item.src) {
        gameFrame.src = item.src;
      } else {
        const doc = gameFrame.contentDocument || gameFrame.contentWindow.document;
        doc.open();
        doc.write('<div style="color:white;padding:20px;">No playable source found.</div>');
        doc.close();
      }
    }

    /* Close modal */
    closeModal.addEventListener('click', () => {
      modal.style.display = 'none';
      // clear iframe content
      try { gameFrame.src = ""; } catch {}
      try {
        const doc = gameFrame.contentDocument || gameFrame.contentWindow.document;
        doc.open();
        doc.write('');
        doc.close();
      } catch {}
    });

    /* Fullscreen */
    fullscreenBtn.addEventListener('click', () => {
      if (gameFrame.requestFullscreen) gameFrame.requestFullscreen();
      else if (gameFrame.webkitRequestFullscreen) gameFrame.webkitRequestFullscreen();
    });

    document.addEventListener('fullscreenchange', () => {
      if (!document.fullscreenElement) {
        // nothing special for now
      }
    });

    /* TAB LOGIC */
    homeTab.addEventListener('click', () => {
      lastActiveTab = "home";
      homeTab.classList.add('active');
      gamesTab.classList.remove('active');
      appsTab.classList.remove('active');
      unlockerTab.classList.remove('active');

      homeSection.style.display = "block";
      gameHero.style.display = "none";
      grid.style.display = "none";
      gamesCountElement.style.display = "none";

      renderHomeStrip();
      renderBigCard();
    });

    gamesTab.addEventListener('click', () => {
      lastActiveTab = "games";
      gamesTab.classList.add('active');
      homeTab.classList.remove('active');
      appsTab.classList.remove('active');
      unlockerTab.classList.remove('active');

      homeSection.style.display = "none";
      gameHero.style.display = "block";
      grid.style.display = "grid";
      gamesCountElement.style.display = "inline-block";

      loadGames();
    });

    appsTab.addEventListener('click', () => {
      lastActiveTab = "apps";
      appsTab.classList.add('active');
      homeTab.classList.remove('active');
      gamesTab.classList.remove('active');
      unlockerTab.classList.remove('active');

      homeSection.style.display = "none";
      gameHero.style.display = "block";
      grid.style.display = "grid";
      gamesCountElement.style.display = "inline-block";

      loadApps();
    });

    unlockerTab.addEventListener('click', () => {
      unlockerTab.classList.add('active');
      homeTab.classList.remove('active');
      gamesTab.classList.remove('active');
      appsTab.classList.remove('active');

      modal.style.display = 'flex';
      gameFrame.src = "https://ihce0h92o3nndk0.pages.dev/";
    });

    /* SEARCH */
    searchInput?.addEventListener('input', () => {
      if (lastActiveTab === "games") render(GAMES);
      if (lastActiveTab === "apps") render(APPS);
    });

    /* COUNT */
    function updateCount() {
      gamesCountElement.textContent =
        "Count: " + (lastActiveTab === "games" ? GAMES.length : APPS.length);
    }

    /* SETTINGS */
    settingsButton.addEventListener('click', () => {
      settingsModal.classList.add('show');
      settingsModal.style.display = 'flex';
    });

    closeSettings.addEventListener('click', () => {
      settingsModal.classList.remove('show');
      setTimeout(() => settingsModal.style.display = 'none', 250);
    });

    /* THEMES (optional themes.json) */
    fetch('themes.json')
      .then(r => r.json())
      .then(data => {
        const options = document.getElementById('themeOptions');
        if (!options) return;
        data.themes.forEach(theme => {
          const div = document.createElement('div');
          div.className = 'theme-option';
          div.textContent = theme.name;

          div.onclick = () => {
            for (const key in theme) {
              try {
                document.documentElement.style.setProperty(key, theme[key]);
              } catch {}
            }
            document.querySelectorAll('.theme-option').forEach(o => o.classList.remove('active'));
            div.classList.add('active');
          };

          options.appendChild(div);
        });
      })
      .catch(() => { /* ignore missing themes.json */ });

    /* START BUTTON (on homepage) */
    const startGamingBtn = document.getElementById('startGamingBtn');
    startGamingBtn.addEventListener('click', () => {
      gamesTab.click();
    });

    /* INITIAL RENDER */
    renderHomeStrip();
    renderBigCard();
  </script>
</body>
</html>
